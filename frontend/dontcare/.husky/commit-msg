#!/bin/sh
set -eu

# Project root = parent of this .husky dir (monorepoâ€‘friendly)
script_dir="$(CDPATH= cd -- "$(dirname -- "$0")" && pwd -P)"
project_root="$script_dir/.."

# Optional Husky shim (present in standard setups)
[ -f "$script_dir/_/husky.sh" ] && . "$script_dir/_/husky.sh"

cd "$project_root"
PATH="$project_root/node_modules/.bin:$PATH"

# Prefer local binary; fall back to npx without installing from registry
if command -v commitlint >/dev/null 2>&1; then
  commitlint --config "$project_root/commitlint.config.mjs" --edit "$1"
else
  npx --no-install commitlint --config "$project_root/commitlint.config.mjs" --edit "$1"
fi